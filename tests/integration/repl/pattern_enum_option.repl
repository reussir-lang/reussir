// RUN: %reussir-repl -i %s -lerror -Oaggressive | %FileCheck %s

// Test: pattern matching on a shallow Option-like enum with nested int patterns

:{
enum Option {
    Some(i32),
    None
}
}:
// CHECK: Definition added.

:{
fn is_some(x: Option) -> bool {
    match x {
        Option::Some(_) => true,
        Option::None => false
    }
}
}:
// CHECK: Definition added.

:{
fn unwrap_or(x: Option, default: i32) -> i32 {
    match x {
        Option::Some(v) => v,
        Option::None => default
    }
}
}:
// CHECK: Definition added.

:{
fn map_double(x: Option) -> Option {
    match x {
        Option::Some(v) => Option::Some{v * 2},
        Option::None => Option::None
    }
}
}:
// CHECK: Definition added.

is_some(Option::Some{5})
// CHECK: true : bool

is_some(Option::None)
// CHECK: false : bool

unwrap_or(Option::Some{42}, 0)
// CHECK: 42 : i32

unwrap_or(Option::None, 99)
// CHECK: 99 : i32

unwrap_or(map_double(Option::Some{3}), 0)
// CHECK: 6 : i32

unwrap_or(map_double(Option::None), 0)
// CHECK: 0 : i32
